*Start Part-8*

*3:44:05
this is the eighth part of a video series dedicated to building a shopping cart application using blazerwebassemblyon.net 6. so at this point we have achieved quite a lot we have created the functionality for displaying grouped products to the user we have also created most of the functionality for the shopping cart 
a user can now add a product to the shopping cart remove a product from the shopping cart and can update the quantity of a product that is contained within the shopping cart so we now need a way for a user to be able to navigate to the shopping cart from anywhere within the application we also want the user to be able to see at a glance how many items are currently contained within the user's shopping cart currently the user is only able to navigate to the shopping cart through our application by adding a product to the shopping cart we want the user to be able to see how many items have been added to the user's shopping cart at a glance no matter where the user is within the application for example the user may be viewing the grouped products displayed to the user when the application is first launched and wishes to know how many items are currently contained within the user's shopping cart we also want the user to be able to navigate to the user's shopping cart through our application from anywhere within the application simply by clicking a button so we want to make this button accessible to the user from anywhere in the application so in this video we'll provide an appropriate solution for this we'll provide a button in the header part of the ui that when clicked will navigate the user to the user's shopping cart the quantity of items stored within the user's shopping cart will be displayed on the text of the relevant button so the quantity value displayed on the relevant button must be kept up to date so we must facilitate the change of the relevant quantity value whenever the number of items within the shopping cart changes the code for the button containing the text representing the number of items in the user's shopping cart will be*

*3:46:30
contained within its own razor component a razor component we'll name cart menu so this means we need to find a way to send data to the cart menu razor component from other relevant razer components like for example the shopping cart razor component whereby code must execute that updates the relevant quantity value when a change to the number of items stored within the user's shopping cart is made in this video we'll see how c-sharp events can be used to facilitate communication of data between the loosely coupled razor components within our application right let's get started let's go to our blazer client component so let's go to the project named shoponline.web let's open the i shopping cart service file let's create a definition for a c-sharp event note that the action type is a delegate that doesn't return a value so any method that the relevant delegate points to will be able to accept the arguments defined within the relevant delegate but the method will not return a value in our case any method pointed to by this delegate will accept one argument of type integer let's create a definition for a method that is responsible for raising the*

*3:47:59
relevant event to subscribed components if what we are doing here is unclear to you don't worry it will become clearer to you as we develop the code in this video okay so let's open the shopping cart service file let's implement the code for the interface items that we have just created let's implement the code for the raise event on shopping cart changed method first we need to check if our event has any subscribers we can do this by evaluating the on shopping cart changed event object so if the on shopping cart changed object is not null this means that the event has subscribers so if the event has subscribers we need to write code that raises the event to those subscribers we can do this by implementing the invoke method on the on shopping cart changed event object then we can send the appropriate integer value to each of our subscribers by passing in the appropriate integer value to the invoke method so in the context of our application an example of a subscriber will be a method within the cart menu razor component that we'll create later in this tutorial when the quantity of the item stored within the user's shopping cart changes the event is raised and a custom method that will be created within the cart menu razor component will be invoked in response to the quantity of items stored within the shopping cart changing basically when the quantity of the shopping cart changes the event is raised and any subscribed methods are called this will be clarified with code that we'll create in a bit so this event being raised will result in the new quantity of items stored within the user's shopping cart being displayed from within the cart menu razor component let's open the products base dot cs file let's write code so that an object of type shopping cart service will be injected into this razor component at runtime so the product razor component is loaded when a user first launches our application we want the user to be able to see how many items are currently stored within the user's shopping cart* 

*3:51:08
when the application is first loaded so let's first appropriately call code on the server to retrieve the shopping cart items currently stored within the user's shopping cart i can feel the comments flowing my way already so i think i'll be preemptive and just say that i'm aware that this may not be the most performant way of doing this but i want to focus on events in relation to razer components in this tutorial we will be optimizing the code in later videos for example by including local storage functionality i don't want to make my videos too convoluted so this is why i sometimes first create simplistic code in certain scenarios so that momentum is gained in the development of our application and then as i said we can always optimize the code in later tutorials right let's write code to calculate the number of items currently stored within the user's shopping cart we can then use the shopping cart service object to raise the appropriate event which will in effect send the quantity of items stored within the user's shopping cart to any subscribers so this will result in the appropriate quantity value being displayed to the user in the header section of the layout of our application let's open the shoppingcartbase.cs file so we want our event to be raised each time the quantity of items stored within the user's shopping cart changes*

*3:52:54
let's create a private method named cart changed let's rationalize our code a bit so that the card summary totals private method is called whenever this card changed method is called and we want our events to be raised whenever the cart changed method is called we want our cart changed method to be called whenever the state of the user's shopping cart is changed so let's appropriately call our method from within the uninitialized async method the delete card item underscore click event handler method and the update qty cart item underscore click event handler method notice that each time we write code to invoke the cart changed method we are replacing the call to the cart summary totals method with the call to our new cart changed method because the calculate summary totals method is now being called from within the cart changed method so let's create the code for the cart menu razer component this component will be displayed in the header section of our layout for our application so let's create a race component called cartmenu.razer within the shared folder let's write code so that an object of type i shopping card service is injected into our cart menu razor component at runtime*

*3:54:52
let's open the underscore imports.razer file and include a using directive that references the shop online dot web dot services dot contracts name space so we are not using inheritance for this component so we can instead include code logic for this razor component within the add code section of our razer file this is because our cart menu razor component is not likely to contain a lot of code logic so we don't necessarily need to abstract the code logic into a separate base class let's define a variable of type integer named shoppingcartitemcount let's create an override for the razer component's uninitialized method this method will be called when our razor component is first rendered so we want our razor component to subscribe to the event that we created in the shopping cart service class to achieve this we can implement this code this means that every time the relevant to achieve this we can implement this code this means that every time the relevant so we haven't yet implemented code for the shopping cart changed method so let's do that*

*3:56:24
so all we are doing is updating our shopping cart item count variable with the quantity value passed into this method from code that executes to raise the relevant event  note that we are calling blazers built in state has changed method here this is an explicit way of telling blazer as it were to re-render the relevant razer component so we are explicitly telling blazer to re-render the component after the shopping cart item count variable has been assigned a new value from code that is raising the relevant event the shopping cart item count will be used in the ui user interface code that we are about to create for displaying the new quantity of items stored within the user's shopping cart so let's write the ui code and this must exist outside the at code section so we want a button displayed to the user that displays a value representing an up-to-date count of items currently stored within the user's shopping cart we also want a user to be able to navigate to the user's shopping cart when this button is clicked*

*3:58:02
in order to prevent possible memory leaks we can write code to unsubscribe from the on shopping cart changed event so to do this let's implement the i disposable interface then we can implement code for the dispose method to unsubscribe from the on shopping cart changed event like this so you can see that the plus equals operator is used to subscribe to an event and the minus equals operator is used to unsubscribe from an event let's open the main layout razor component from within the shared folder this component is responsible for displaying the main ui layout of our application we can ensure that our cart menu razor component displays within the header section by including the appropriate tag for our cart menu razer component here so let's run the code excellent so notice that when we are using a mobile view when running the application*

*4:00:07
we are not able to see our header menu item so let's write code to allow for users*
