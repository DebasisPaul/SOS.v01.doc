*start Part 7*
*30 Min Read*

*3:14:05
this is the seventh part of a video series dedicated to building a shopping cart application using blazerwebassembly on .net 6. so in the previous part of this series we created functionality whereby a user can delete an item from the user's shopping cart in this video we are going to `create the functionality` whereby a user is able to update the quantity of a particular product that has been placed within the user's shopping cart a notable feature that we'll add is `the showing and hiding of the update qty button` so we only want the update qty button to appear when the user changes the appropriate value in the field denoting the quantity of a particular item in the user's shopping cart when the relevant field is changed the relevant update qty button appears once the user has clicked the update qty button to update the quantity of a particular item in the user's shopping cart we want the update qty button to disappear to achieve the appropriate showing and hiding of the update qty button we are going to invoke a javascript method this brings us to an important question how do we integrate javascript into our blazor webassembly component in this video we are going to look at how we can use blazor javascript*

*[ASP.NET Core Blazor JavaScript interoperability (JS interop)](https://docs.microsoft.com/en-us/aspnet/core/blazor/javascript-interoperability/?view=aspnetcore-6.0) [JavaScript Function Invocation](https://www.w3schools.com/js/js_function_invocation.asp)*

*3:15:46
interoperability feature to interact with javascript code from within our blazer webassembly component we'll implement this functionality toward the end of the video so please stick around to the end to learn about javascript interoperability with blazer to start with let's create the server-side code for the update qty functionality so let's get started let's go to the shoponline.api project let's open the shopping cart repository class let's implement the code logic for the update qty method first thing to do is reference the item that we wish to update so if we are able to find the relevant item within our database and therefore the item variable will not be null we can then update the qty field with the value passed in from the client and to commit the change to the database we must of course call the save changes async method let's write code to return null to the calling client for when the item is not found within the database let's expose the update quantity functionality to our calling client through an action method let's open the shopping cart controller class let's create an action method named update qty let's appropriately call the update qty method on the shopping cart repository object to update the relevant resource with the qty value passed into our action method by the client let's use our convert to dto method to appropriately convert the cart item object into an object of type cart item dto we can then write code to return the relevant object of type cart item dto to the calling client along with the http code status of 200 ok let's include the appropriate exception handling code so we have so far created action methods that correspond to the http get verb the http post verb and the http delete verb the other two most common http verbs are the http put verb and the http patch verb the http put verb and the http patch verb are both associated with the performance of resource updates the difference between these two http verbs is that the http put verb is associated with action methods that modify a resource where the client sends data that updates the entire resource the http patch verb however is associated with action methods that partially update the respective resource so we want our update qty method to update only the qty field for a cart item resource so this means it is appropriate to associate our update qty action method with the http patch verb we can write declarative code to indicate that this action method is associated with a http patch verb to do this we can appropriately decorate the update qty action method with the http patch attribute like this note that we are passing in data to the http patch attribute that provides necessary route template information this indicates that the uri for the relevant endpoint must appropriately contain the id of the resource that the client wishes to modify right let's write the appropriate code for the blazer component so let's go to the shoponline.web project*

*[9 Variables](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/variables) [null (C# Reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/null) [Databases](https://docs.microsoft.com/en-us/sql/relational-databases/databases/databases?view=sql-server-ver16) [Shopping Cart
](https://docs.microsoft.com/en-us/aspnet/web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart) [Object-Oriented programming (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/tutorials/oop) [Objects - create instances of types](https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/object-oriented/objects) [DbContext.SaveChangesAsync Method](https://docs.microsoft.com/en-us/dotnet/api/system.data.entity.dbcontext.savechangesasync?view=entity-framework-6.2.0) [Action Delegate](https://docs.microsoft.com/en-us/dotnet/api/system.action?view=net-6.0) [Create Data Transfer Objects (DTOs)](https://docs.microsoft.com/en-us/aspnet/web-api/overview/data/using-web-api-with-entity-framework/part-5) [Configure endpoints for the ASP.NET Core Kestrel web server](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel/endpoints?view=aspnetcore-7.0) [Uri Class](https://docs.microsoft.com/en-us/dotnet/api/system.uri?view=net-6.0) [Routing in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-6.0) [RouteTemplate Class](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.routing.template.routetemplate?view=aspnetcore-6.0) [Routing to controller actions in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/routing?view=aspnetcore-6.0)*

*[PATCH](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PATCH) [PUT](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT) [DELETE](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/DELETE) [POST
](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST) [HTTP request methods](https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/exceptions/) [200 OK](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200) [https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200](https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/exceptions/)*

*3:21:10
let's open the i shopping cart service class let's open the shopping cart service class to implement the code logic for the update qty method let's first serialize the dto that we wish to pass to the server into json format let's create an object of type string content so that we can appropriately pass the relevant data in the appropriate format to the server let's call the patch async method on our http client object and pass in the appropriate uri as well as the relevant data to the patch async method if the http response status code falls within the success range let's include code that returns the appropriate data returned from the server to the calling code let's go to the shopping cart base class let's create a method that will handle the update qty button click event so the calling code will pass in the id of the shopping cart item that the user wishes to update as well as the relevant quantity value if the quantity value is greater than zero meaning that the quantity or qty field value is valid we can appropriately call the update qty method on the shopping cart service object to call the relevant server side code in order to update the database appropriately*

*[Service Class](https://docs.microsoft.com/en-us/dotnet/api/system.web.services.description.service?view=netframework-4.8) [Serialization (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/serialization/) [Introducing JSON](https://www.json.org/json-en.html) [Servers in Computer Network](https://www.geeksforgeeks.org/servers-in-computer-network/) [Fields (C# Programming Guide)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/fields) [onclick Event](https://www.w3schools.com/jsref/event_onclick.asp) [Methods (C# Programming Guide)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/methods) [base (C# Reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/base) [this (C# Reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/this) [HTTP response status codes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status) [HttpClient Class](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient?view=net-6.0) [HttpClient.PatchAsync Method](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.patchasync?view=net-6.0) [Strings and string literals](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/) [StringContent Class](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.stringcontent?view=net-6.0)*

*3:25:35
else if the calling code passes in an invalid quantity let's set the quantity field for the relevant cart item to one let's go to the shopping cart dot razor a file let's add an input field that will allow a user to modify the quantity of a particular item in the user's shopping cart note that we are using blazers at bind syntax to bind each quantity input field to the corresponding property of the appropriate object of type cart item dto stored within the shopping cart items collection this means for example that if the qty property for a cart item dto object stored within the shopping cart items collection is modified that this modification will immediately be reflected on the ui in the appropriate quantity input field let's create the update qty button that a user can click in order to update the quantity of a particular item let's use blazes at onclick syntax to call the appropriate event handler method that we have created within the*

*[Model Binding in ASP.NET Core](https://github.com/DebasisPaul/SOS.v01.doc/edit/master/SOS-Doc-Part-7.md) [Selection statements (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/statements/selection-statements) [Iteration statements (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/statements/iteration-statements)*

*3:27:47
shopping cart base class let's stand by our convention to use the underscore click suffix for these type of event handler methods so let's change the name of the relevant method from update qty cart item to update qty cart item underscore click then we can write code to pass in the appropriate values to our update qty cart item underscore click method let's test the code great so we haven't yet written code so that the total quantity and total price is reflected within the cart item summary information displayed to the user on the right-hand side of the user's screen let's implement the code for this so firstly let's include two properties within our shopping cart base class let's include a property to store the total price of the items within the user's shopping cart and the total quantity of the items stored within the user's shopping cart let's create a private method named set total price which is responsible for calculating the total price of all the items stored within the user's shopping cart and assigning the result of this calculation to the relevant property let's create a private method named calculate cart item summary totals let's call the set total price method as well as the set total quantity method from within the calculate cart summary totals method we want the total price of all the items stored within the user's shopping cart as well as the total quantity of items*

*[Access Modifiers (C# Reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/access-modifiers) [Constructors (C# programming guide)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/constructors) [Properties in C#](https://docs.microsoft.com/en-us/dotnet/csharp/properties) [Nullable reference types](https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references)* 

*3:32:17
stored within the user's shopping cart to be reflected on the ui whenever a user action results in the state of the shopping cart changing so let's appropriately call our calculate card summary totals method from within the update qty cart item underscore click event handler method the delete cart item underscore click event handler method the delete cart item underscore click event handler method and the on initialized async method that is called when the razer component is rendered let's go to the shoppingcart.racer file and implement the code that will result in the appropriate summary totals being reflected appropriately on the ui before we run the code we must also include a method in the shopping cart base class that updates the total price property on the relevant object of type cart item dto when the relevant quantity property is updated for a particular cart item by the user so basically if for example a cart item has a price of 50 dollars and the user updates its quantity property from one to two we need to change the cart items total price from fifty dollars to a hundred dollars
to calculate the total price is simply a mathematical operation of price multiplied by quantity so let's create a method named update item total price let's call our get card item private method to reference the relevant cart item then we can update its total price property with the result of the calculation that we have just discussed we want our update item total price method invoked every time the quantity for an item within the user's shopping cart changes so let's implement the code for this appropriately great let's run the code excellent so let's look at javascript interoperability in a blazer webassembly component let's implement the code so that our update qty button is only shown to the user when the state of the relevant input field changes so let's first create a css file for our shopping cart razor component so let's create a css file named shoppingcart.razer.css as discussed when we create a css file that only applies to a specific razor component we must adhere to a specific naming convention let's create a css class named update dash qty that contains the code display colon none so we can apply this class to the update qty button like this to ensure that when the relevant razer component first loads that the update qty button is not displayed to the user so the next step is to create a*

*[C# operators and expressions (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/) [ASP.NET Core Razor components](https://docs.microsoft.com/en-us/aspnet/core/blazor/components/?view=aspnetcore-6.0) [CSS: Cascading Style Sheets](https://developer.mozilla.org/en-US/docs/Web/CSS) [ASP.NET Core Blazor JavaScript interoperability (JS interop)](https://docs.microsoft.com/en-us/aspnet/core/blazor/javascript-interoperability/?view=aspnetcore-6.0) [ASP.NET Core Blazor](https://docs.microsoft.com/en-us/aspnet/core/blazor/?view=aspnetcore-6.0) [Host and deploy ASP.NET Core Blazor
](https://docs.microsoft.com/en-us/aspnet/core/blazor/host-and-deploy/?view=aspnetcore-6.0&tabs=visual-studio) [Secure ASP.NET Core Blazor WebAssembly](https://docs.microsoft.com/en-us/aspnet/core/blazor/security/webassembly/?view=aspnetcore-6.0) [ASP.NET Core Blazor project structure](https://docs.microsoft.com/en-us/aspnet/core/blazor/project-structure?view=aspnetcore-6.0)*

*3:37:14
javascript method that is invoked when the quantity input field is changed by the user this javascript method will be responsible for appropriately showing and hiding the relevant update qty button let's create a folder within the www
root folder of our project named js let's add a javascript file named shoppingcartfunctions.js to the js folder let's create a javascript function named make update qty button visible this function accepts two arguments one denotes the id of the relevant cart item and the other denotes a boolean value so in order to be able to identify the relevant button within our javascript code we can apply a data attribute to the relevant html element so let's go to our shoppingcart.razer file and include a data attribute named data dash item id and set its value to the id of the relevant cart item the code for the javascript function is
fairly basic let's use our data attribute to reference the appropriate button element we are using the data dash item id data attribute to identify a specific update qty button if the boolean value is true we want code to execute within our javascript function to make the relevant button visible if the boolean value is false we want our function to make the relevant button
invisible let's appropriately reference our new javascript file from within the index.html file then we need to write code to detect when a quantity input field or qty input field is changed by the user we can use blaze's at on input syntax*

*[How TO - Toggle Hide and Show](https://www.w3schools.com/howto/howto_js_toggle_hide_show.asp) [<input>: The Input (Form Input) element](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Input) [Method definitions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Method_definitions) [bool (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/bool) [Value types (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/value-types) [Boolean logical operators (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/boolean-logical-operators) [Boolean Struct](https://docs.microsoft.com/en-us/dotnet/api/system.boolean?view=net-6.0) [HTML elements reference](https://developer.mozilla.org/en-US/docs/Web/HTML/Element) [Attributes (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/attributes/) [DataAttribute Class](https://docs.microsoft.com/en-us/dotnet/api/system.data.linq.mapping.dataattribute?view=netframework-4.8) [Named and Optional Arguments (C# Programming Guide)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/named-and-optional-arguments) [Main() and command-line arguments](https://docs.microsoft.com/en-US/dotnet/csharp/fundamentals/program-structure/main-command-line) [js Functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions)* 

*3:40:29
for this purpose one might think that the at on change syntax should be used for this purpose but a method executed in response to the at once syntax will only be invoked when the relevant input field loses focus we want our method to be invoked immediately when the relevant input field's value changes so let's implement a method within the shoppingcartbase.cs class that will be invoked when a quantity input field is changed so we want our make update qty button visible javascript function to be invoked when a quantity input field is changed so how can we call a javascript function from within a razer component the answer to this is that we can use the built-in js runtime type for this purpose so let's create a property of type i js runtime
let's decorate this property with the inject attribute so that an appropriate object of type ijs runtime will be injected into our razor component at runtime we can then use the object to appropriately call our make update qty button visible javascript function like this let's go to our shopping cart dot race of file and appropriately call our update qty underscore input method lastly let's write code that calls the relevant javascript function to make the relevant update qty button disappear once the relevant button has been clicked let's run the code excellent*

*[ASP.NET Core Blazor dependency injection](https://docs.microsoft.com/en-us/aspnet/core/blazor/fundamentals/dependency-injection?view=aspnetcore-6.0) [IJSRuntime Interface](https://docs.microsoft.com/en-us/dotnet/api/microsoft.jsinterop.ijsruntime?view=aspnetcore-6.0) [JSRuntime Class](https://docs.microsoft.com/en-us/dotnet/api/microsoft.jsinterop.jsruntime?view=aspnetcore-6.0) [Asynchronous programming with async and await](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/) [+ and += operators (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/addition-operator) [- and -= operators (C# reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/subtraction-operator) [Asynchronous programming](https://docs.microsoft.com/en-us/dotnet/csharp/async) [async (C# Reference)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/async)*

*End Part-7*
